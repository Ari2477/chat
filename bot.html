<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Assistant - Ultimate AI Bot</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Base styles */
        .back-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .back-btn i {
            font-size: 18px;
            transition: transform 0.2s ease;
        }

        .back-btn:hover {
            background: var(--bg-hover);
            color: var(--primary);
        }

        .back-btn:hover i {
            transform: translateX(-3px);
        }

        .back-btn:active {
            transform: scale(0.95);
        }

        body.light-mode .back-btn {
            color: #64748b;
        }

        body.light-mode .back-btn:hover {
            background: rgba(79,70,229,0.05);
            color: var(--primary);
        }

        /* Camera button */
        .camera-btn {
            width: 42px;
            height: 42px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .camera-btn:hover {
            background: var(--bg-hover);
            color: var(--primary);
            transform: scale(1.1);
        }

        .camera-btn i {
            font-size: 20px;
        }

        /* Loading animation */
        .typing-indicator-bot {
            display: flex;
            gap: 4px;
            padding: 12px 16px;
            background: var(--bg-input);
            border-radius: 20px;
            border-bottom-left-radius: 6px;
            align-self: flex-start;
            margin: 5px 0;
        }

        .typing-indicator-bot span {
            width: 8px;
            height: 8px;
            background: var(--text-muted);
            border-radius: 50%;
            animation: typingBounce 1.4s infinite;
        }

        .typing-indicator-bot span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator-bot span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingBounce {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-6px); }
        }

        /* Message image preview */
        .message-image-preview {
            max-width: 200px;
            max-height: 200px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 2px solid var(--primary);
            cursor: pointer;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-dark);
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            box-shadow: var(--shadow-lg);
            z-index: 9999;
            border: 1px solid var(--border-color);
        }
    </style>
</head>
<body style="display: flex; align-items: center; justify-content: center; min-height: 100vh; background: #0a0c10;">
    <div class="bot-container">
        <div class="bot-header">
            <button class="back-btn" onclick="goBack()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="bot-avatar">
                <img src="https://i.ibb.co/KjkPv6xw/Ilustraci-n-de-dibujos-animados-lindo-robot-agitando-la-mano-Vector-Premium.jpg" alt="Bot">
            </div>
            <div class="bot-info">
                <h2>Mini Assistant</h2>
                <p><i class="fas fa-circle"></i> Online ‚Ä¢ AI Powered</p>
            </div>
        </div>

        <div class="quick-replies">
            <button class="quick-reply-btn" onclick="sendQuickReply('/help')">
                <i class="fas fa-question-circle"></i> /help
            </button>
            <button class="quick-reply-btn" onclick="sendQuickReply('/ai')">
                <i class="fas fa-robot"></i> /ai
            </button>
            <button class="quick-reply-btn" onclick="sendQuickReply('/sim')">
                <i class="fas fa-comment"></i> /sim
            </button>
            <button class="quick-reply-btn" onclick="sendQuickReply('/botinfo')">
                <i class="fas fa-info-circle"></i> /info
            </button>
        </div>

        <div id="botMessages" class="bot-messages-container">
            <div class="welcome-message">
                <i class="fas fa-robot" style="font-size: 32px; color: var(--primary); margin-bottom: 10px; display: block;"></i>
                Hi! I'm Mini Assistant.<br>Type <strong>/help</strong> to see commands!
            </div>
        </div>

        <div class="bot-input-container">
            <input type="text" id="botMessageInput" placeholder="Type /help for commands..." onkeypress="handleKeyPress(event)">
            <button class="camera-btn" onclick="handleImageUpload()" title="Upload Image for AI">
                <i class="fas fa-camera"></i>
            </button>
            <button class="bot-send-btn" onclick="sendMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <script>
        // ============================================
        // API CONFIGURATIONS - LAHAT WORKING!
        // ============================================
        const API_CONFIG = {
            // Gemini AI - working with images!
            gemini: "https://jrmtool-api.vercel.app/api/gemini",
            
            // SimSimi - working chat!
            sim: {
                url: "https://simsimi-api-pro.onrender.com/sim",
                key: "a650beda66094d58b3e5c84b664420e8f2e65edd"
            },
            
            // IMGBB - working image upload!
            imgbb: "87b58d438e0cbe5226c1df0a8071621e",
            
            // Dictionary - working!
            dictionary: "https://api.dictionaryapi.dev/api/v2/entries/en",
            
            // Datamuse - working synonyms/antonyms!
            datamuse: "https://api.datamuse.com/words"
        };

        // User data
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('userId');
        const userName = urlParams.get('userName') || 'User';
        const userPfp = urlParams.get('userPfp') || 'https://ui-avatars.com/api/?name=User&background=4f46e5&color=fff';

        // Data collections
        const jokes = [
            "Why don't scientists trust atoms? Because they make up everything!",
            "Why did the scarecrow win an award? He was outstanding in his field!",
            "What do you call a fake noodle? An impasta!",
            "Why did the math book look sad? Because it had too many problems!",
            "What do you call a bear with no teeth? A gummy bear!",
            "Why can't you give Elsa a balloon? Because she will let it go!",
            "What do you call a sleeping bull? A bulldozer!",
            "Why did the coffee file a police report? It got mugged!",
            "What do you call a fish with no eyes? A fsh!",
            "Why don't skeletons fight each other? They don't have the guts!"
        ];

        const facts = [
            "Honey never spoils. Archaeologists found 3000-year-old honey!",
            "A day on Venus is longer than a year on Venus.",
            "Bananas are berries, but strawberries aren't.",
            "Octopuses have three hearts and blue blood.",
            "The Eiffel Tower can be 15 cm taller during summer.",
            "A cloud can weigh around a million pounds.",
            "There's a species of jellyfish that's immortal.",
            "The shortest war in history lasted 38 minutes.",
            "Cows have best friends and get stressed when separated.",
            "A group of flamingos is called a 'flamboyance'!"
        ];

        const quotes = [
            "The only way to do great work is to love what you do. - Steve Jobs",
            "Life is what happens when you're busy making other plans. - John Lennon",
            "The future belongs to those who believe in their dreams. - Eleanor Roosevelt",
            "Success is not final, failure is not fatal. - Winston Churchill",
            "Believe you can and you're halfway there. - Theodore Roosevelt",
            "Everything you've ever wanted is on the other side of fear. - George Addair",
            "Don't watch the clock; do what it does. Keep going. - Sam Levenson",
            "The future depends on what you do today. - Mahatma Gandhi",
            "You miss 100% of the shots you don't take. - Wayne Gretzky",
            "The journey of a thousand miles begins with one step. - Lao Tzu"
        ];

        let userNotes = JSON.parse(localStorage.getItem('botNotes')) || [];

        // ============================================
        // HELPER FUNCTIONS
        // ============================================
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // ============================================
        // API FUNCTIONS - LAHAT PURE FETCH! (NO AXIOS)
        // ============================================

        // ‚úÖ GEMINI AI - WORKING!
        async function fetchGemini(prompt, imageUrl = null) {
            try {
                let url;
                if (imageUrl) {
                    url = `${API_CONFIG.gemini}?ask=${encodeURIComponent(prompt)}&imagurl=${encodeURIComponent(imageUrl)}`;
                } else {
                    url = `${API_CONFIG.gemini}?ask=${encodeURIComponent(prompt)}&imagurl=`;
                }
                
                const response = await fetch(url);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                return data.response || data.message || data.text || "I'm not sure how to respond.";
            } catch (error) {
                console.error('Gemini error:', error);
                return "‚ùå Gemini AI is unavailable. Please try again later.";
            }
        }

        // ‚úÖ SIMSIMI - WORKING!
        async function fetchSimSimi(message) {
            try {
                const url = `${API_CONFIG.sim.url}?query=${encodeURIComponent(message)}&apikey=${API_CONFIG.sim.key}`;
                const response = await fetch(url);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                return data.message || data.response || data.text || "I don't understand.";
            } catch (error) {
                console.error('SimSimi error:', error);
                return "‚ùå SimSimi is unavailable. Try /ai instead.";
            }
        }

        // ‚úÖ IMAGE UPLOAD - WORKING!
        async function uploadImage(file) {
            return new Promise((resolve, reject) => {
                const formData = new FormData();
                formData.append('image', file);
                
                fetch(`https://api.imgbb.com/1/upload?key=${API_CONFIG.imgbb}`, {
                    method: 'POST',
                    body: formData
                })
                .then(r => r.json())
                .then(data => {
                    if (data.success) resolve(data.data.url);
                    else reject(data.error?.message || 'Upload failed');
                })
                .catch(reject);
            });
        }

        // ‚úÖ DICTIONARY - WORKING!
        async function defineWord(word) {
            try {
                const response = await fetch(`${API_CONFIG.dictionary}/${encodeURIComponent(word)}`);
                if (!response.ok) throw new Error('Not found');
                
                const data = await response.json();
                let result = `üìñ **${word}**\n\n`;
                data[0].meanings.forEach(m => {
                    result += `*${m.partOfSpeech}*\n`;
                    m.definitions.slice(0, 2).forEach(d => {
                        result += `‚Ä¢ ${d.definition}\n`;
                        if (d.example) result += `  ‚úèÔ∏è "${d.example}"\n`;
                    });
                });
                return result;
            } catch {
                return `‚ùå No definition found for "${word}".`;
            }
        }

        // ‚úÖ SYNONYMS - WORKING!
        async function getSynonyms(word) {
            try {
                const response = await fetch(`${API_CONFIG.datamuse}?rel_syn=${encodeURIComponent(word)}&max=10`);
                const data = await response.json();
                if (!data.length) return `‚ùå No synonyms found for "${word}".`;
                
                return `üî§ **Synonyms of "${word}":**\n` + 
                       data.map((item, i) => `${i+1}. ${item.word}`).join('\n');
            } catch {
                return `‚ùå Could not find synonyms.`;
            }
        }

        // ‚úÖ ANTONYMS - WORKING!
        async function getAntonyms(word) {
            try {
                const response = await fetch(`${API_CONFIG.datamuse}?rel_ant=${encodeURIComponent(word)}&max=10`);
                const data = await response.json();
                if (!data.length) return `‚ùå No antonyms found for "${word}".`;
                
                return `üîÑ **Antonyms of "${word}":**\n` + 
                       data.map((item, i) => `${i+1}. ${item.word}`).join('\n');
            } catch {
                return `‚ùå Could not find antonyms.`;
            }
        }

        // ============================================
        // IMAGE UPLOAD HANDLER
        // ============================================
        async function handleImageUpload() {
            const input = document.getElementById('botMessageInput');
            const message = input.value.trim();
            
            if (!message.startsWith('/ai')) {
                showToast("‚ö†Ô∏è Type '/ai [question]' first!");
                input.focus();
                return;
            }
            
            const prompt = message.replace('/ai', '').trim();
            if (!prompt) {
                showToast("‚ùå Add a question after /ai");
                input.focus();
                return;
            }
            
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = 'image/*';
            
            fileInput.onchange = async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                addBotMessage(`üì§ Uploading image...`, false);
                
                try {
                    const imageUrl = await uploadImage(file);
                    
                    // Remove uploading message
                    const msgs = document.getElementById('botMessages');
                    if (msgs.lastChild.textContent.includes('Uploading')) {
                        msgs.lastChild.remove();
                    }
                    
                    // Show user message with image
                    addUserMessageWithImage(prompt, imageUrl);
                    
                    showTyping();
                    
                    const response = await fetchGemini(prompt, imageUrl);
                    
                    hideTyping();
                    addBotMessage(`ü§ñ **AI says:**\n${response}`, false);
                    
                    input.value = '';
                    
                } catch (error) {
                    hideTyping();
                    addBotMessage(`‚ùå Upload failed: ${error.message}`, false);
                }
            };
            
            fileInput.click();
        }

        // ============================================
        // MESSAGE FUNCTIONS
        // ============================================
        function addBotMessage(text, isUser = false) {
            const container = document.getElementById('botMessages');
            const wrapper = document.createElement('div');
            wrapper.className = `bot-message-wrapper ${isUser ? 'user' : ''}`;
            
            if (!isUser) {
                const avatar = document.createElement('div');
                avatar.className = 'bot-message-avatar';
                avatar.innerHTML = '<img src="https://i.ibb.co/KjkPv6xw/Ilustraci-n-de-dibujos-animados-lindo-robot-agitando-la-mano-Vector-Premium.jpg" alt="Bot">';
                wrapper.appendChild(avatar);
            }
            
            const content = document.createElement('div');
            content.className = 'bot-message-content';
            
            if (!isUser) {
                const name = document.createElement('div');
                name.className = 'bot-name-tag';
                name.innerHTML = '<i class="fas fa-robot"></i> Mini Assistant';
                content.appendChild(name);
            }
            
            const textDiv = document.createElement('div');
            textDiv.className = 'bot-message-text';
            textDiv.innerHTML = text.replace(/\n/g, '<br>');
            content.appendChild(textDiv);
            
            const time = document.createElement('div');
            time.className = 'bot-message-time';
            time.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            content.appendChild(time);
            
            wrapper.appendChild(content);
            
            const welcome = container.querySelector('.welcome-message');
            if (welcome) welcome.remove();
            
            container.appendChild(wrapper);
            container.scrollTop = container.scrollHeight;
        }

        function addUserMessageWithImage(prompt, imageUrl) {
            const container = document.getElementById('botMessages');
            const wrapper = document.createElement('div');
            wrapper.className = 'bot-message-wrapper user';
            
            const content = document.createElement('div');
            content.className = 'bot-message-content';
            
            const textDiv = document.createElement('div');
            textDiv.className = 'bot-message-text';
            textDiv.innerHTML = `
                <img src="${imageUrl}" class="message-image-preview" onclick="window.open('${imageUrl}')">
                <br><strong>Prompt:</strong> ${prompt}
            `;
            content.appendChild(textDiv);
            
            const time = document.createElement('div');
            time.className = 'bot-message-time';
            time.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            content.appendChild(time);
            
            wrapper.appendChild(content);
            container.appendChild(wrapper);
            container.scrollTop = container.scrollHeight;
        }

        function showTyping() {
            const container = document.getElementById('botMessages');
            const typing = document.createElement('div');
            typing.className = 'typing-indicator-bot';
            typing.id = 'typingIndicator';
            typing.innerHTML = '<span></span><span></span><span></span>';
            container.appendChild(typing);
            container.scrollTop = container.scrollHeight;
        }

        function hideTyping() {
            const typing = document.getElementById('typingIndicator');
            if (typing) typing.remove();
        }

        // ============================================
        // COMMANDS
        // ============================================
        function getHelp() {
            return `‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ
‚îÇ   ü§ñ **COMMANDS**   ‚îÇ
‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ

‚ï≠‚îÅ‚îÅ‚îÅ **[ AI & CHAT ]** ‚îÅ‚îÅ‚îÅ‚ïÆ
‚îÉ ü§ñ /ai [question] ‚Ä¢ Ask AI (with image)
‚îÉ üí¨ /sim [message] ‚Ä¢ Chat with SimSimi
‚ï∞‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïØ

‚ï≠‚îÅ‚îÅ‚îÅ **[ FUN ]** ‚îÅ‚îÅ‚îÅ‚ïÆ
‚îÉ üòÇ /joke ‚Ä¢ Random joke
‚îÉ ü§î /fact ‚Ä¢ Random fact
‚îÉ üí≠ /quote ‚Ä¢ Inspiration
‚ï∞‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïØ

‚ï≠‚îÅ‚îÅ‚îÅ **[ DICTIONARY ]** ‚îÅ‚îÅ‚îÅ‚ïÆ
‚îÉ üìñ /define [word] ‚Ä¢ Definition
‚îÉ üî§ /synonym [word] ‚Ä¢ Synonyms
‚îÉ üîÑ /antonym [word] ‚Ä¢ Antonyms
‚ï∞‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïØ

‚ï≠‚îÅ‚îÅ‚îÅ **[ MATH ]** ‚îÅ‚îÅ‚îÅ‚ïÆ
‚îÉ üßÆ /calc [exp] ‚Ä¢ Calculate
‚îÉ ‚ûó /math [exp] ‚Ä¢ Math solver
‚ï∞‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïØ

‚ï≠‚îÅ‚îÅ‚îÅ **[ UTILITIES ]** ‚îÅ‚îÅ‚îÅ‚ïÆ
‚îÉ üìù /note [text] ‚Ä¢ Save note
‚îÉ üìã /notes ‚Ä¢ View notes
‚îÉ ‚è≤Ô∏è /timer [sec] ‚Ä¢ Set timer
‚îÉ üîî /remind [text] ‚Ä¢ Reminder
‚îÉ ‚ÑπÔ∏è /botinfo ‚Ä¢ Bot info
‚îÉ üßπ /clear ‚Ä¢ Clear chat
‚ï∞‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïØ

üì∏ **IMAGE:** Type /ai + question, click üì∑`;
        }

        function getBotInfo() {
            return `ü§ñ **BOT INFO**

‚ï≠‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïÆ
‚îÉ Mini Assistant
‚îÉ Version 3.0
‚ï∞‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïØ

üìä **STATUS:**
‚úÖ Gemini AI (with images)
‚úÖ SimSimi Chat
‚úÖ Dictionary
‚úÖ Synonyms/Antonyms
‚úÖ Image Upload
‚úÖ 20+ Commands

üîß Created by **ARI** with ‚ù§Ô∏è

üí° /ai + üì∑ for images!`;
        }

        function getJoke() {
            return `üòÇ **Joke:**\n${jokes[Math.floor(Math.random() * jokes.length)]}`;
        }

        function getFact() {
            return `ü§î **Fact:**\n${facts[Math.floor(Math.random() * facts.length)]}`;
        }

        function getQuote() {
            return `üí≠ **Quote:**\n${quotes[Math.floor(Math.random() * quotes.length)]}`;
        }

        function calculate(expr) {
            try {
                const result = Function('"use strict";return (' + expr + ')')();
                return `üßÆ **Result:** ${expr} = ${result}`;
            } catch {
                return "‚ùå Invalid expression!";
            }
        }

        // Auto responses
        const autoReplies = {
            'hello': 'Hello! üëã How can I help?',
            'hi': 'Hi there! üåü',
            'hey': 'Hey! üòä',
            'thank': 'You\'re welcome! üëç',
            'bye': 'Goodbye! üëã',
            'default': 'Interesting! Tell me more. üëÇ'
        };

        function getAutoReply(msg) {
            const lower = msg.toLowerCase();
            for (let [key, reply] of Object.entries(autoReplies)) {
                if (lower.includes(key)) return reply;
            }
            return autoReplies.default;
        }

        // ============================================
        // MAIN PROCESSOR
        // ============================================
        async function processCommand(msg) {
            const parts = msg.split(' ');
            const cmd = parts[0].toLowerCase();
            const args = parts.slice(1).join(' ');

            // General
            if (cmd === '/help') return getHelp();
            if (cmd === '/botinfo' || cmd === '/info') return getBotInfo();
            if (cmd === '/clear') {
                document.getElementById('botMessages').innerHTML = '';
                return "Chat cleared!";
            }

            // Fun
            if (cmd === '/joke') return getJoke();
            if (cmd === '/fact') return getFact();
            if (cmd === '/quote') return getQuote();

            // Math
            if (cmd === '/calc' && args) return calculate(args);
            if (cmd === '/math' && args) return calculate(args);

            // Notes
            if (cmd === '/note' && args) {
                userNotes.push({ text: args, date: new Date().toLocaleString() });
                localStorage.setItem('botNotes', JSON.stringify(userNotes));
                return "üìù Note saved!";
            }
            if (cmd === '/notes') {
                if (!userNotes.length) return "üì≠ No notes.";
                return "üìã **Notes:**\n" + userNotes.map((n, i) => `${i+1}. ${n.text}`).join('\n');
            }

            // Timer
            if (cmd === '/timer' && args) {
                let sec = parseInt(args);
                if (isNaN(sec)) return "‚ùå Invalid seconds!";
                setTimeout(() => addBotMessage(`‚è∞ Timer done! ${sec}s`, false), sec * 1000);
                return `‚è≤Ô∏è Timer set for ${sec}s`;
            }

            // Reminder
            if (cmd === '/remind' && args) {
                setTimeout(() => addBotMessage(`üîî Reminder: ${args}`, false), 10000);
                return "‚úÖ Reminder set (10s)";
            }

            // Dictionary
            if (cmd === '/define' && args) return await defineWord(args);
            if (cmd === '/synonym' && args) return await getSynonyms(args);
            if (cmd === '/antonym' && args) return await getAntonyms(args);

            // AI (text only)
            if (cmd === '/ai' && args) {
                let response = await fetchGemini(args);
                return `ü§ñ **AI says:**\n${response}`;
            }
            if (cmd === '/ai' && !args) {
                return "‚ùå Add a question. Example: /ai what is love?";
            }

            // SimSimi
            if (cmd === '/sim' && args) {
                let response = await fetchSimSimi(args);
                return `üí¨ **SimSimi says:**\n${response}`;
            }

            return null;
        }

        // ============================================
        // SEND MESSAGE
        // ============================================
        async function sendMessage() {
            const input = document.getElementById('botMessageInput');
            const msg = input.value.trim();
            if (!msg) return;

            addBotMessage(msg, true);
            input.value = '';
            showTyping();

            try {
                let reply;
                if (msg.startsWith('/')) {
                    reply = await processCommand(msg);
                    if (!reply) reply = "‚ùå Unknown command. Try /help";
                } else {
                    reply = getAutoReply(msg);
                }
                
                hideTyping();
                addBotMessage(reply, false);
            } catch (e) {
                hideTyping();
                addBotMessage("‚ùå Error: " + e.message, false);
            }
        }

        function sendQuickReply(text) {
            document.getElementById('botMessageInput').value = text;
            sendMessage();
        }

        function handleKeyPress(e) {
            if (e.key === 'Enter') sendMessage();
        }

        function goBack() {
            window.location.href = 'index.html';
        }

        // Welcome
        document.addEventListener('DOMContentLoaded', () => {
            if (userName !== 'User') {
                setTimeout(() => {
                    addBotMessage(`Welcome back, ${userName}! üëã All APIs working!`, false);
                }, 500);
            }
        });
    </script>
</body>
</html>

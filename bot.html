<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini Assistant - AI Powered</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        .back-btn {
            width: 36px;
            height: 36px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .back-btn i {
            font-size: 18px;
            transition: transform 0.2s ease;
        }

        .back-btn:hover {
            background: var(--bg-hover);
            color: var(--primary);
        }

        .back-btn:hover i {
            transform: translateX(-3px);
        }

        .back-btn:active {
            transform: scale(0.95);
        }

        body.light-mode .back-btn {
            color: #64748b;
        }

        body.light-mode .back-btn:hover {
            background: rgba(79,70,229,0.05);
            color: var(--primary);
        }
    </style>
</head>
<body style="display: flex; align-items: center; justify-content: center; min-height: 100vh; background: #0a0c10;">
    <div class="bot-container">
        <div class="bot-header">
            <button class="back-btn" onclick="goBack()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <div class="bot-avatar">
                <img src="https://i.ibb.co/KjkPv6xw/Ilustraci-n-de-dibujos-animados-lindo-robot-agitando-la-mano-Vector-Premium.jpg" alt="Bot">
            </div>
            <div class="bot-info">
                <h2>Mini Assistant</h2>
                <p><i class="fas fa-circle"></i> Online â€¢ AI Powered</p>
            </div>
        </div>

        <div class="quick-replies">
            <button class="quick-reply-btn" onclick="sendQuickReply('/help')">
                <i class="fas fa-question-circle"></i> /help
            </button>
            <button class="quick-reply-btn" onclick="sendQuickReply('/ai Hello')">
                <i class="fas fa-robot"></i> /ai
            </button>
            <button class="quick-reply-btn" onclick="sendQuickReply('/sim Hello')">
                <i class="fas fa-comment"></i> /sim
            </button>
            <button class="quick-reply-btn" onclick="sendQuickReply('/botinfo')">
                <i class="fas fa-info-circle"></i> /botinfo
            </button>
        </div>

        <div id="botMessages" class="bot-messages-container">
            <div class="welcome-message">
                <i class="fas fa-robot" style="font-size: 32px; color: var(--primary); margin-bottom: 10px; display: block;"></i>
                Hi! I'm Mini Assistant. Type <strong>/help</strong> to see all commands!
            </div>
        </div>

        <div class="bot-input-container">
            <input type="text" id="botMessageInput" placeholder="Type /help for commands..." onkeypress="handleBotKeyPress(event)">
            <button class="bot-send-btn" onclick="sendBotMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <script>
        const API_CONFIG = {
            ai: {
                endpoint: "https://echoai-api-qsh3.onrender.com/chat",
                method: "POST"
            },
            sim: {
                endpoint: "https://simsimi-api-pro.onrender.com/sim?query=",
                key: "a650beda66094d58b3e5c84b664420e8f2e65edd"
            }
        };

        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('userId');
        const userName = urlParams.get('userName') || 'User';
        const userPfp = urlParams.get('userPfp') || 'https://ui-avatars.com/api/?name=User&background=4f46e5&color=fff';

        const jokes = [
            "Why don't scientists trust atoms? Because they make up everything!",
            "Why did the scarecrow win an award? He was outstanding in his field!",
            "Why don't eggs tell jokes? They'd crack each other up!",
            "What do you call a fake noodle? An impasta!",
            "Why did the math book look sad? Because it had too many problems!",
            "What do you call a bear with no teeth? A gummy bear!",
            "Why can't you give Elsa a balloon? Because she will let it go!",
            "What do you call a sleeping bull? A bulldozer!",
            "Why did the coffee file a police report? It got mugged!",
            "What do you call a fish with no eyes? A fsh!",
            "Why don't skeletons fight each other? They don't have the guts!",
            "What do you call a pig that does karate? A pork chop!",
            "Why did the bicycle fall over? Because it was two-tired!",
            "How does a penguin build its house? Igloos it together!",
            "Why did the golfer bring two pairs of pants? In case he got a hole in one!"
        ];

        const facts = [
            "Honey never spoils. Archaeologists found 3000-year-old honey in Egyptian tombs!",
            "A day on Venus is longer than a year on Venus.",
            "Bananas are berries, but strawberries aren't.",
            "Octopuses have three hearts and blue blood.",
            "The Eiffel Tower can be 15 cm taller during summer.",
            "Your brain is constantly eating itself - it's called phagocytosis!",
            "A cloud can weigh around a million pounds.",
            "There's a species of jellyfish that's immortal.",
            "The shortest war in history lasted 38 minutes.",
            "Cows have best friends and get stressed when separated.",
            "A group of flamingos is called a 'flamboyance'!",
            "The world's oldest known living tree is over 5,000 years old.",
            "Humans share 60% of their DNA with bananas.",
            "A single strand of spaghetti is called a 'spaghetto'.",
            "The nose can remember 50,000 different scents."
        ];

        const quotes = [
            "The only way to do great work is to love what you do. - Steve Jobs",
            "Life is what happens when you're busy making other plans. - John Lennon",
            "The future belongs to those who believe in the beauty of their dreams. - Eleanor Roosevelt",
            "Success is not final, failure is not fatal: it is the courage to continue that counts. - Winston Churchill",
            "Believe you can and you're halfway there. - Theodore Roosevelt",
            "It does not matter how slowly you go as long as you do not stop. - Confucius",
            "Everything you've ever wanted is on the other side of fear. - George Addair",
            "The only limit to our realization of tomorrow will be our doubts of today. - Franklin D. Roosevelt",
            "Don't watch the clock; do what it does. Keep going. - Sam Levenson",
            "The future depends on what you do today. - Mahatma Gandhi",
            "You miss 100% of the shots you don't take. - Wayne Gretzky",
            "The best time to plant a tree was 20 years ago. The second best time is now.",
            "Happiness is not something ready made. It comes from your own actions. - Dalai Lama",
            "Your time is limited, don't waste it living someone else's life. - Steve Jobs",
            "The journey of a thousand miles begins with one step. - Lao Tzu"
        ];

        let userNotes = JSON.parse(localStorage.getItem('botNotes')) || [];

        function getHelpResponse() {
            return `â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚   ğŸ¤– **BOT COMMANDS**   â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

â•­â”â”â” **[ GENERAL ]** â”â”â”â•®
â”ƒ ğŸ’¬ \`/help\` â€¢ Show this menu
â”ƒ ğŸ‘‹ \`/hi\` â€¢ Greeting message
â”ƒ â„¹ï¸ \`/botinfo\` â€¢ Bot information
â”ƒ â° \`/time\` â€¢ Current time
â”ƒ ğŸ“… \`/date\` â€¢ Today's date
â”ƒ ğŸ§¹ \`/clear\` â€¢ Clear chat
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

â•­â”â”â” **[ AI & CHAT ]** â”â”â”â•®
â”ƒ ğŸ¤– \`/ai [msg]\` â€¢ Talk to advanced AI *(NEW API!)*
â”ƒ ğŸ’¬ \`/sim [msg]\` â€¢ Chat with SimSimi
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

â•­â”â”â” **[ FUN ]** â”â”â”â•®
â”ƒ ğŸ˜‚ \`/joke\` â€¢ Random funny joke
â”ƒ ğŸ¤” \`/fact\` â€¢ Interesting fact
â”ƒ ğŸ’­ \`/quote\` â€¢ Inspirational quote
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

â•­â”â”â” **[ DICTIONARY ]** â”â”â”â•®
â”ƒ ğŸ“– \`/define [word]\` â€¢ Word definition
â”ƒ ğŸ”¤ \`/synonym [word]\` â€¢ Find synonyms
â”ƒ ğŸ”„ \`/antonym [word]\` â€¢ Find antonyms
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

â•­â”â”â” **[ MATH ]** â”â”â”â•®
â”ƒ ğŸ§® \`/calc [exp]\` â€¢ Basic calculator
â”ƒ â— \`/math [exp]\` â€¢ Math problem solver
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

â•­â”â”â” **[ UTILITIES ]** â”â”â”â•®
â”ƒ ğŸ“ \`/note [text]\` â€¢ Save a note
â”ƒ ğŸ“‹ \`/notes\` â€¢ View all notes
â”ƒ â²ï¸ \`/timer [sec]\` â€¢ Set a timer
â”ƒ ğŸ”” \`/remind [text]\` â€¢ Set reminder
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”`;
        }

        function getBotInfo() {
            return `ğŸ¤– **BOT INFORMATION**

â•­â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•®
â”ƒ **Mini Assistant** 
â”ƒ Version 2.0
â”ƒ AI API: EchoAI
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•¯

ğŸ“Š **STATISTICS:**
â€¢ Commands: 20+
â€¢ Auto-responses: 200+
â€¢ Users: Active community
â€¢ Uptime: 24/7

âš™ï¸ **FEATURES:**
â€¢ AI Chat
â€¢ SimSimi Chat 
â€¢ Jokes & Facts
â€¢ Dictionary
â€¢ Calculator
â€¢ Notes
â€¢ Timer
â€¢ Reminder

ğŸ”§ **DEVELOPER:**
Created by **ARI** with â¤ï¸
Built for Mini Messenger

ğŸŒ **API STATUS:**
â€¢ /ai: EchoAI âœ…
â€¢ /sim: SimSimi âœ…
â€¢ Others: Built-in

ğŸ’¡ **Tip:** Type /help to see all commands!`;
        }

        async function fetchAIResponse(message) {
            try {
                const response = await fetch(API_CONFIG.ai.endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: message,
                        user: userName || 'User'
                    })
                });

                if (!response.ok) {
                    throw new Error(`API responded with status: ${response.status}`);
                }

                const data = await response.json();
                
                if (data.response) {
                    return data.response;
                } else if (data.message) {
                    return data.message;
                } else if (data.text) {
                    return data.text;
                } else if (typeof data === 'string') {
                    return data;
                } else {
                    return "I'm here to help! What would you like to know?";
                }
            } catch (error) {
                console.error('AI API error:', error);
                const fallbacks = [
                    "That's interesting! Tell me more.",
                    "I understand. What else would you like to know?",
                    "Great question! Let me think about that.",
                    "I'm here to help! What else can I do for you?",
                    "Thanks for sharing that with me!"
                ];
                return `ğŸ¤– **EchoAI says:**\n${fallbacks[Math.floor(Math.random() * fallbacks.length)]}`;
            }
        }

        async function fetchSimSimiResponse(message) {
            try {
                const url = `${API_CONFIG.sim.endpoint}${encodeURIComponent(message)}&key=${API_CONFIG.sim.key}`;
                const response = await fetch(url);
                const data = await response.json();
                return data.message || "Sorry, I don't understand.";
            } catch (error) {
                console.error('SimSimi error:', error);
                return "ğŸ’¬ SimSimi service unavailable. Please try again later.";
            }
        }

        async function getDictionaryDefinition(word) {
            try {
                const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${encodeURIComponent(word)}`);
                const data = await response.json();
                
                if (data.title === "No Definitions Found") {
                    return `âŒ No definition found for "${word}".`;
                }

                const entry = data[0];
                let definition = `ğŸ“– **Definition of "${word}":**\n\n`;
                
                entry.meanings.forEach((meaning, i) => {
                    definition += `*${meaning.partOfSpeech}*\n`;
                    meaning.definitions.slice(0, 2).forEach(def => {
                        definition += `  â€¢ ${def.definition}\n`;
                        if (def.example) {
                            definition += `    âœï¸ Example: "${def.example}"\n`;
                        }
                    });
                    definition += '\n';
                });

                return definition;
            } catch {
                return `âŒ Could not find definition for "${word}".`;
            }
        }

        async function getSynonyms(word) {
            try {
                const response = await fetch(`https://api.datamuse.com/words?rel_syn=${encodeURIComponent(word)}&max=10`);
                const data = await response.json();
                
                if (data.length === 0) {
                    return `âŒ No synonyms found for "${word}".`;
                }

                let result = `ğŸ”¤ **Synonyms for "${word}":**\n`;
                data.forEach((item, i) => {
                    result += `${i + 1}. ${item.word}\n`;
                });
                return result;
            } catch {
                return `âŒ Could not find synonyms for "${word}".`;
            }
        }

        async function getAntonyms(word) {
            try {
                const response = await fetch(`https://api.datamuse.com/words?rel_ant=${encodeURIComponent(word)}&max=10`);
                const data = await response.json();
                
                if (data.length === 0) {
                    return `âŒ No antonyms found for "${word}".`;
                }

                let result = `ğŸ”„ **Antonyms for "${word}":**\n`;
                data.forEach((item, i) => {
                    result += `${i + 1}. ${item.word}\n`;
                });
                return result;
            } catch {
                return `âŒ Could not find antonyms for "${word}".`;
            }
        }

        function getJoke() {
            return jokes[Math.floor(Math.random() * jokes.length)];
        }

        function getFact() {
            return facts[Math.floor(Math.random() * facts.length)];
        }

        function getQuote() {
            return quotes[Math.floor(Math.random() * quotes.length)];
        }

        function calculate(expression) {
            try {
                const result = Function('"use strict";return (' + expression + ')')();
                return `ğŸ§® **Result:** ${expression} = ${result}`;
            } catch {
                return "âŒ Invalid math expression!";
            }
        }

        const autoResponses = {
            'hello': 'Hello! ğŸ‘‹ How can I help you today?',
            'hi': 'Hi there! ğŸŒŸ What\'s up?',
            'hey': 'Hey! ğŸ˜Š Nice to see you!',
            'good morning': 'Good morning! â˜€ï¸ Have a great day!',
            'good afternoon': 'Good afternoon! ğŸŒ¤ï¸ How\'s your day going?',
            'good evening': 'Good evening! ğŸŒ™ Ready to chat?',
            'good night': 'Good night! ğŸ˜´ Sleep well!',

            'who is your creator': 'My creator is **ARI**! ğŸ‘‘ He\'s an amazing developer! Type /botinfo for more details!',
            'who made you': 'I was created by **ARI**! ğŸš€ He\'s the mastermind behind my code!',
            'your creator': '**ARI** is my creator! ğŸ’» He designed me to be your helpful assistant!',

            'what is your name': 'I\'m **Mini Assistant**! ğŸ¤– Your friendly AI helper!',
            'your name': 'My name is **Mini Assistant**! ğŸ“› What\'s yours?',
            'who are you': 'I\'m **Mini Assistant**, an AI bot created to help you! ğŸŒŸ',

            'thank you': 'You\'re very welcome! ğŸ˜Š Anything else?',
            'thanks': 'My pleasure! ğŸŒŸ Happy to help!',
            'thank': 'You\'re welcome! ğŸ‘',
            
            'goodbye': 'Goodbye! ğŸ‘‹ Come back anytime!',
            'bye': 'Bye bye! ğŸˆ It was nice chatting with you!',
            'see you later': 'See you later! ğŸŒŸ Take care!',

            'default1': 'That\'s interesting! Tell me more! ğŸ‘‚',
            'default2': 'I understand. What else would you like to know? ğŸ¤”',
            'default3': 'Great point! Let\'s chat more! ğŸ˜Š',
            'default4': 'I see! Thanks for sharing that with me!'
        };

        function addBotMessage(text, isUser = false, isBot = false) {
            const messagesDiv = document.getElementById('botMessages');
            const wrapper = document.createElement('div');
            wrapper.className = `bot-message-wrapper ${isUser ? 'user' : ''}`;
            
            if (!isUser) {
                const avatarDiv = document.createElement('div');
                avatarDiv.className = 'bot-message-avatar';
                avatarDiv.innerHTML = '<img src="https://ui-avatars.com/api/?name=AI&background=4f46e5&color=fff" alt="Bot">';
                wrapper.appendChild(avatarDiv);
            }
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'bot-message-content';
            
            if (!isUser) {
                const nameDiv = document.createElement('div');
                nameDiv.className = 'bot-name-tag';
                nameDiv.innerHTML = '<i class="fas fa-robot"></i> Mini Assistant';
                contentDiv.appendChild(nameDiv);
            }
            
            const textDiv = document.createElement('div');
            textDiv.className = 'bot-message-text';
            textDiv.innerHTML = text.replace(/\n/g, '<br>');
            
            contentDiv.appendChild(textDiv);
            
            const timeDiv = document.createElement('div');
            timeDiv.className = 'bot-message-time';
            timeDiv.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            contentDiv.appendChild(timeDiv);
            
            wrapper.appendChild(contentDiv);
            
            const welcomeMsg = messagesDiv.querySelector('.welcome-message');
            if (welcomeMsg && !isUser) {
                welcomeMsg.remove();
            }
            
            messagesDiv.appendChild(wrapper);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function showBotTyping() {
            const messagesDiv = document.getElementById('botMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator-bot';
            typingDiv.id = 'botTypingIndicator';
            typingDiv.innerHTML = '<span></span><span></span><span></span>';
            messagesDiv.appendChild(typingDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        function removeBotTyping() {
            const typingIndicator = document.getElementById('botTypingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        function getAutoResponse(message) {
            const lowerMsg = message.toLowerCase().trim();

            for (const [key, response] of Object.entries(autoResponses)) {
                if (lowerMsg === key) {
                    return response;
                }
            }
            
            for (const [key, response] of Object.entries(autoResponses)) {
                if (lowerMsg.includes(key) && key.length > 3) {
                    return response;
                }
            }

            const defaults = ['default1', 'default2', 'default3', 'default4'];
            return autoResponses[defaults[Math.floor(Math.random() * defaults.length)]];
        }

        async function processCommand(message) {
            const parts = message.split(' ');
            const command = parts[0].toLowerCase();
            const args = parts.slice(1).join(' ');

            if (command === '/help') {
                return getHelpResponse();
            }

            if (command === '/botinfo' || command === '/info') {
                return getBotInfo();
            }

            if (command === '/hi') {
                return "Hello! ğŸ‘‹ How can I help you today?";
            }

            if (command === '/time') {
                return `ğŸ• **Current Time:** ${new Date().toLocaleTimeString()}`;
            }

            if (command === '/date') {
                return `ğŸ“… **Today's Date:** ${new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}`;
            }

            if (command === '/clear') {
                document.getElementById('botMessages').innerHTML = '';
                return "Chat cleared! Type /help to see commands.";
            }

            if (command === '/joke') {
                return `ğŸ˜‚ **Joke:**\n${getJoke()}`;
            }

            if (command === '/fact') {
                return `ğŸ¤” **Did you know?**\n${getFact()}`;
            }

            if (command === '/quote') {
                return `ğŸ’­ **Quote:**\n${getQuote()}`;
            }

            if (command === '/calc' && args) {
                return calculate(args);
            }

            if (command === '/math' && args) {
                return calculate(args);
            }

            if (command === '/note' && args) {
                userNotes.push({ text: args, date: new Date().toLocaleString() });
                localStorage.setItem('botNotes', JSON.stringify(userNotes));
                return `ğŸ“ Note saved! Use /notes to view all notes.`;
            }

            if (command === '/notes') {
                if (userNotes.length === 0) {
                    return "ğŸ“­ No notes yet. Use /note [text] to create one.";
                }
                let notesText = "ğŸ“‹ **YOUR NOTES:**\n\n";
                userNotes.forEach((note, index) => {
                    notesText += `${index + 1}. ${note.text} (${note.date})\n`;
                });
                return notesText;
            }

            if (command === '/timer' && args) {
                const seconds = parseInt(args);
                if (isNaN(seconds)) {
                    return "âŒ Please enter a valid number of seconds!";
                }
                setTimeout(() => {
                    addBotMessage(`â° **Timer finished!** ${seconds} seconds have passed.`, false, true);
                }, seconds * 1000);
                return `â²ï¸ Timer set for ${seconds} seconds. I'll remind you!`;
            }

            if (command === '/remind' && args) {
                setTimeout(() => {
                    addBotMessage(`ğŸ”” **Reminder:** ${args}`, false, true);
                }, 10000);
                return `âœ… Reminder set: "${args}" (I'll remind you in 10 seconds)`;
            }

            if (command === '/define' && args) {
                return await getDictionaryDefinition(args);
            }

            if (command === '/synonym' && args) {
                return await getSynonyms(args);
            }

            if (command === '/antonym' && args) {
                return await getAntonyms(args);
            }

            if (command === '/ai' && args) {
                const response = await fetchAIResponse(args);
                return `ğŸ¤– **AI says:**\n${response}`;
            }

            if (command === '/sim' && args) {
                const response = await fetchSimSimiResponse(args);
                return `ğŸ’¬ **SimSimi says:**\n${response}`;
            }

            return null;
        }

        async function sendBotMessage() {
            const input = document.getElementById('botMessageInput');
            const message = input.value.trim();
            
            if (!message) return;

            addBotMessage(message, true);
            input.value = '';
            
            showBotTyping();

            setTimeout(async () => {
                removeBotTyping();
                
                let response;

                if (message.startsWith('/')) {
                    response = await processCommand(message);
                    if (!response) {
                        response = "âŒ Unknown command. Type /help to see available commands.";
                    }
                } else {
                    response = getAutoResponse(message);
                }
                
                addBotMessage(response, false, true);
            }, 800);
        }

        function sendQuickReply(text) {
            document.getElementById('botMessageInput').value = text;
            sendBotMessage();
        }

        function handleBotKeyPress(event) {
            if (event.key === 'Enter') {
                sendBotMessage();
            }
        }

        function goBack() {
            window.location.href = 'index.html';
        }

        document.addEventListener('DOMContentLoaded', function() {
            if (userName !== 'User') {
                setTimeout(() => {
                    addBotMessage(`Welcome back, ${userName}! ğŸ‘‹ I'm your assistant! Type /help to see all commands!`, false, true);
                }, 500);
            }
        });
    </script>
</body>
</html>
